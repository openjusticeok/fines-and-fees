---
title: "Fines and fees"
author:
  - Ashley Harvey, Justice Data Analyst
  - Open Justice Oklahoma
date: "`r Sys.Date()`"
output:
  html_document:
    number_sections: yes
    toc: yes
    toc_float: yes
  pdf_document:
    toc: yes
---

```{r setup, include=FALSE}
library(ojo)
library(knitr)


nc <- function(x) {comma(x, digits = 0)}

```

Background information: Why are we researching this topic? What is the expected product? A blog post? Analysis for an internal or external partner? 

Salient topic this legislative session/ legislative priority. 3 blog posts. Currently for internal work.  

> **How much is being charged in fines and fees throughout the state?**
> **What proportion of court debt from criminal cases is collected?**
> **What proportion of court collections comes from misdemeanor and felony cases?**

# Data sources

ojo database- OSCN & ODCR (mins & pays tables)
Court administrator reports 

## Timeframe
Fees assessed and paid 2015-2018

Case file years- 2008:2018
min_years & pay_years- 2014:2019 (2014 & 2019 in order to convert to fiscal year to allow comparison with court administrator reports)

## Geography

The whole state/ all counties

## Variables
Felony (CF) & misdeamnor (CM) cases
min_type = "fees"

## Query

If you're using data from the OJO database, include the query you used to pull your data. This may be a function that starts `ojo_query_` or `dbGetQuery`.

``` {r}
#### OSCN ####
oscn_fees <- ojo_query_mins(oscn_counties, c("CF", "CM"), 2008:2018, min_years = 2014:2019, min_type = "fees")
oscn_pays <- ojo_query_pays(oscn_counties, c("CF", "CM"), 2008:2018, pay_years = 2014:2019)

#### ODCR ####
odcr_fees <- ojo_query_mins(odcr_counties, c("CF", "CM"), 2008:2018, min_years = 2014:2019, min_type = "fees")
odcr_pays <- ojo_query_pays(odcr_counties, c("CF", "CM"), 2008:2018, pay_years = 2014:2019)
```

# Checking Data

Explain the results of the checks of your data.

## Check for Completeness

If you're using court data, you can use the `ojo_check_comp` to see how complete the data is.

```{r}
# ojo_check_comp(sc)
```

## Check for NAs

Detail the NAs and blank items in your data and, if necessary and possible, fill them in.

``` {r}
# rog_nas <- rog %>% 
#   summarize(nas = sum(is.na(defname) | defname == "")) # checks for NA and blank ("") defendant names
# 
# rog_nas
```

## Check for outliers

If you're looking at numeric data, look at the highest and lowest values and explain your procedures to deal with them in this section.

# Defining Measures

This is where you'll likely spend the biggest chunk of time if you're using court data. There are a lot of ways things can go wrong, so we want to be able to trace back all of our steps and document all the decisions we're making.

Because each analysis project is a bit different, the number and length of subsections in this section will vary a lot. 

## Measure 1

Describe how you defined the first measure.

# Summarizing and Visualizing Data

There will likely be several sections here too. Summarize and visualize the data in different ways and identify trends that you see.

## Summary 1

- How you summarized and why
- How you visualized the data
- Potential leads and trends

```{r results="asis", echo=FALSE}
cat("
<style>
body {
  padding-top: 63px;
}

h1.title.toc-ignore {
  font-family: 'Pluto Sans';
  font-weight: bold;
  background-color: #F8D64E;
}

h1, h2, h3 {
  font-family: 'Pluto Sans';
  font-weight: bold;
}

#TOC {
  font-family: 'Menlo'
}

.list-group-item.active, .list-group-item.active:focus, .list-group-item.active:hover {
    font-weight: bold;
    color: black;
    background-color: #F8D64E;
}

p a {
  color: black;
  background-color: #F8D64E;
  font-weight: bold;
}

</style>
")
```
